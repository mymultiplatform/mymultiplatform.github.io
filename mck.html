<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Coverage Debug (Inches Only)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 16px; }
    .box { border: 1px solid #ccc; border-radius: 10px; padding: 12px; max-width: 900px; }
    label { display:block; margin-top: 10px; font-size: 13px; }
    input, button {
      font-size: 14px; padding: 10px; border-radius: 8px; border: 1px solid #bbb;
      width: 100%; box-sizing: border-box;
    }
    button { cursor:pointer; width:auto; }
    .row { display:flex; gap: 10px; flex-wrap: wrap; align-items: end; }
    .row > div { flex: 1; min-width: 200px; }
    canvas { border:1px solid #333; margin-top: 12px; background:#fff; width: 100%; height: auto; }
    .meta { margin-top: 10px; font-size: 13px; color:#222; line-height: 1.35; }
    .warn { color:#8a4b00; font-weight:700; }
    .ok { color:#0a7a2f; font-weight:700; }
    .small { font-size:12px; color:#444; margin-top:6px; }
  </style>
</head>
<body>

<h2>Coverage Debug (Inches Only)</h2>

<div class="box">
  <div class="small">
    Enter inches like <b>1902"</b> (must include the quote symbol). Sheet is square: <b>60"</b> means 60"×60".
  </div>

  <div class="row">
    <div>
      <label>Target Width (in)</label>
      <input id="targetW" value='1902"' />
    </div>
    <div>
      <label>Target Height (in)</label>
      <input id="targetH" value='18920"' />
    </div>
    <div>
      <label>Sheet Size (square, in)</label>
      <input id="sheetS" value='60"' />
    </div>
    <div style="flex:0 0 auto;">
      <label>&nbsp;</label>
      <button onclick="run()">Draw</button>
    </div>
  </div>

  <div id="meta" class="meta"></div>

  <canvas id="cv" width="1100" height="700"></canvas>

  <div class="small">
    <b>Legend:</b> Gray outline = target. Solid boxes = full sheets. Dashed boxes = cut sheets on edges.
  </div>
</div>

<script>
function parseInchesStrict(s){
  if (typeof s !== 'string') return NaN;
  const str = s.trim();
  // must end with "
  if (!str.endsWith('"')) return NaN;
  const num = str.slice(0, -1).trim();
  if (!/^[0-9]*\.?[0-9]+$/.test(num)) return NaN;
  return Number(num);
}

function run(){
  const tW = parseInchesStrict(document.getElementById('targetW').value);
  const tH = parseInchesStrict(document.getElementById('targetH').value);
  const s  = parseInchesStrict(document.getElementById('sheetS').value);

  const meta = document.getElementById('meta');
  const cv = document.getElementById('cv');
  const ctx = cv.getContext('2d');
  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,cv.width,cv.height);

  if (![tW,tH,s].every(v => isFinite(v) && v > 0)){
    meta.innerHTML = `<span class="warn">Inputs must be inches like 60"</span>`;
    return;
  }

  const cols = Math.ceil(tW / s);
  const rows = Math.ceil(tH / s);
  const count = cols * rows;

  const coveredW = cols * s;
  const coveredH = rows * s;

  // Fit view to covered area (so you see full grid)
  const pad = 30;
  const worldW = Math.max(tW, coveredW);
  const worldH = Math.max(tH, coveredH);
  const scale = Math.min((cv.width - 2*pad)/worldW, (cv.height - 2*pad)/worldH);

  const X = (x)=> pad + x*scale;
  const Y = (y)=> pad + y*scale;
  const W = (w)=> w*scale;
  const H = (h)=> h*scale;

  // Draw sheets grid
  for (let r=0; r<rows; r++){
    for (let c=0; c<cols; c++){
      const x = c*s;
      const y = r*s;

      // determine cut size at edges
      const cutW = Math.min(s, tW - x);
      const cutH = Math.min(s, tH - y);
      const isCut = (cutW < s) || (cutH < s);

      const drawW = Math.max(0, cutW);
      const drawH = Math.max(0, cutH);

      // skip if outside target entirely (can happen when target exactly fits and we’re at boundary math)
      if (drawW <= 0 || drawH <= 0) continue;

      // fill
      ctx.fillStyle = isCut ? "rgba(220,220,220,0.75)" : "rgba(200,200,200,0.55)";
      ctx.fillRect(X(x), Y(y), W(drawW), H(drawH));

      // stroke
      ctx.save();
      ctx.strokeStyle = "#111";
      ctx.lineWidth = 1;
      if (isCut) ctx.setLineDash([6,4]);
      else ctx.setLineDash([]);
      ctx.strokeRect(X(x), Y(y), W(drawW), H(drawH));
      ctx.restore();
    }
  }

  // Draw target outline on top
  ctx.save();
  ctx.strokeStyle = "#555";
  ctx.lineWidth = 2;
  ctx.setLineDash([]);
  ctx.strokeRect(X(0), Y(0), W(tW), H(tH));
  ctx.restore();

  // Stats
  const overW = coveredW - tW;
  const overH = coveredH - tH;

  meta.innerHTML = `
    <div><span class="ok">Sheets:</span> ${count} total (${cols} across × ${rows} down)</div>
    <div>Target: ${tW}" × ${tH}"</div>
    <div>Sheet: ${s}" × ${s}"</div>
    <div>Covered: ${coveredW}" × ${coveredH}"</div>
    <div>Overhang: +${overW}" width, +${overH}" height</div>
  `;
}
</script>

</body>
</html>
